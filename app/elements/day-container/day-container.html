<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-localstorage/iron-localstorage.html">
<link rel="import" href="../time-entry/time-entry.html">
<dom-module id="day-container">
    <template>
        <style>
        :host {
            display: block;
            margin-bottom: 8rem;
        }
        
        header {
            height: 8rem;
            border-bottom: var(--color-border) 1px solid;
        }
        
        h3 {
            margin: 0;
            padding: 0;
            font-size: 16px;
            font-family: Lato, sans-serif;
            font-weight: 600;
            line-height: 8rem;
            float: left;
        }
        
        button {
            margin: 1.5rem 0 0 0;
            float: right;
            height: 5rem;
            border: var(--color-border) 1px solid;
            background: #FFF;
            border-radius: 4px;
            padding: 0 2rem;
            box-shadow: var(--shadow);
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: .05em;
            font-weight: 600;
            outline: none;
        }
        </style>
        <iron-localstorage name$="day-[[day]]" value="{{data}}" on-iron-localstorage-load-empty="_initDay"></iron-localstorage>
        <header>
            <h3>
                [[_displayDay(day)]]
            </h3>
            <button on-tap="_newEntry">
                Add Entry
            </button>
        </header>
        <template is="dom-repeat" items="{{data}}">
            <time-entry data="{{item}}" projects="[[projects]]" tasks="[[tasks]]"></time-entry>
        </template>
    </template>
    <script>
    Polymer({
        is: 'day-container',

        properties: {
            day: {
                type: Number
            },
            data: {
                type: Array,
                value: []
            }
        },

        ready: function() {

        },

        _initDay: function() {
            this.data = [];
        },

        _newEntry: function() {

            this.push('data', {
                duration: 0,
                project: 0,
                task: 0,
                comment: '',
                createdAt: (new Date().getTime())
            });
        },

        _displayDay: function(day) {
            var dateTemp = new Date(day);
            var monthArray = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
            var weekdayArray = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

            return dateTemp.getDate() + '. ' + monthArray[dateTemp.getMonth()] + ', ' + weekdayArray[dateTemp.getDay()];
        }
    });
    </script>
</dom-module>
